import lit.formats
import os

config.name = "Glu functional tests"
config.test_format = lit.formats.ShTest(execute_external=True)
config.suffixes = ['.glu']

# Preserve shell environment so tools like rustup/cargo can locate their configs.
config.environment = dict(os.environ)

# Add LLVM tools directory to PATH without dropping existing entries.
llvm_tools_dir = '@LLVM_TOOLS_BINARY_DIR@'
config.llvm_tools_version = '@GLU_LLVM_VERSION@'
if llvm_tools_dir and os.path.isdir(llvm_tools_dir):
    path = config.environment.get('PATH', '')
    config.environment['PATH'] = llvm_tools_dir + os.pathsep + path if path else llvm_tools_dir

config.substitutions = [
    ('gluc', '@GLUC_PATH@'),
    ('glu-demangle', '@GLUDEMANGLE_PATH@'),
    ('lldb', '@LLDB_CONF@')
]

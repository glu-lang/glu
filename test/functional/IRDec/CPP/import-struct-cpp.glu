//
// RUN: mkdir -p %t
// RUN: clang++ -std=c++20 -g -c -emit-llvm %S/struct.cpp -o %t/person.bc
// RUN: gluc %s --linker clang++ -I %t -o %t/import-cpp && %t/import-cpp | FileCheck -v %s
//

import person::Person;

@no_mangling @c_variadic func printf(s: *Char) -> Int;

func main() {
    let emil = Person::getEmil();
    // CHECK: Person name is Emil, born in 2003
    printf("Person name is %s, born in %u\n", emil.name, emil.birthYear);
    // CHECK: Emil's age in 2025 is 22
    printf("Emil's age in 2025 is %u\n", Person::getAgeInYear(&emil, 2025));
    // CHECK: Emil's current age is {{.*}}
    printf("Emil's current age is %u\n", Person::getCurrentAge(&emil));
    let marouan: Person = { "Marouan", 2000 };
    // CHECK: Marouan's age in 2025 is 25
    printf("Marouan's age in 2025 is %u\n", Person::getAgeInYear(&marouan, 2025));
    // CHECK: Marouan's current age is {{.*}}
    printf("Marouan's current age is %u\n", Person::getCurrentAge(&marouan));
}

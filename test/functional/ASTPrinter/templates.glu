//
// RUN: gluc --print-astgen %s | FileCheck -v %s
// RUN: gluc --print-ast %s 2>&1 | FileCheck -v %s --check-prefix=AST
//

// CHECK:    FunctionDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:1>
// CHECK:      -->TemplateParams:
// CHECK-NEXT:        TemplateParameterList {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK-NEXT:          -->TemplateParameters:
// CHECK-NEXT:            TemplateParameterDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK-NEXT:              -->Name: T
func identity<T>(value: T) -> T {
    return value;
}

// CHECK:    FunctionDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:1>
// CHECK:      -->TemplateParams:
// CHECK-NEXT:        TemplateParameterList {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK-NEXT:          -->TemplateParameters:
// CHECK-NEXT:            TemplateParameterDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK-NEXT:              -->Name: T
// CHECK-NEXT:            TemplateParameterDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK-NEXT:              -->Name: U
func choose<T, U>(first: T, second: U) -> T {
    return first;
}

// CHECK:    StructDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:1>
// CHECK:      -->TemplateParams:
// CHECK-NEXT:        TemplateParameterList {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK-NEXT:          -->TemplateParameters:
// CHECK-NEXT:            TemplateParameterDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK-NEXT:              -->Name: T
struct Box<T> {
    value: T,
}

// CHECK:    StructDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:1>
// CHECK:      -->TemplateParams:
// CHECK-NEXT:        TemplateParameterList {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK-NEXT:          -->TemplateParameters:
// CHECK-NEXT:            TemplateParameterDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK-NEXT:              -->Name: T
// CHECK-NEXT:            TemplateParameterDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK-NEXT:              -->Name: U
struct Pair<T, U> {
    first: T,
    second: U,
}

// CHECK:    VarDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK:      -->Name: boxedInt
// CHECK:      -->Type: UNRESOLVED[Box<UNRESOLVED[Int]>]
// AST:    VarDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// AST:      -->Name: boxedInt
// AST:      -->Type: Box<Int32>
var boxedInt: Box<Int>;

// CHECK:    TypeAliasDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK:      -->Name: Maybe
// CHECK:      -->Type: UNRESOLVED[Box<UNRESOLVED[T]>]
typealias Maybe<T> = Box<T>;

// CHECK:    TypeAliasDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK:      -->Name: Either
// CHECK:      -->Type: UNRESOLVED[Pair<UNRESOLVED[T], UNRESOLVED[U]>]
typealias Either<T, U> = Pair<T, U>;

// CHECK:    FunctionDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:1>
// CHECK:      -->Name: takesBox
// CHECK:      -->Params:
// CHECK:        ParamDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// CHECK:          -->value : UNRESOLVED[Box<UNRESOLVED[T]>]
// AST:        ParamDecl {{0x[0-9a-f]+}} <line:{{[0-9]+}}:{{[0-9]+}}>
// AST:          -->value : Box<T>
func takesBox<T>(value: Box<T>) -> Void { }

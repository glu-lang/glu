//
// RUN: gluc %s --print-ast | FileCheck -v %s --check-prefix=CHECK-AST
//

struct Inner {
    value: Int
}

func copy(i: Inner) -> Inner {
    var newInner: Inner;
    newInner.value = i.value;
    return newInner;
}

struct Outer {
    inner: Inner,
    data: Int
}

// CHECK-AST: StructDecl
// CHECK-AST: -->Name: Outer
// CHECK-AST: -->Copy function:

func copy(o: Outer) -> Outer {
    var newOuter: Outer;
    newOuter.inner = o.inner; // This should trigger copy for Inner
    newOuter.data = o.data;
    return newOuter;
}

func main() -> Int {
    var inner: Inner;
    inner.value = 42;
    
    var outer: Outer;
    outer.inner = inner;
    outer.data = 100;
    
    var outerCopy: Outer = outer; // This should trigger copy for Outer
    
    return 0;
}
